---
draft: true
date: 
  created: 2024-09-01
  updated: 2025-01-02
categories:
  - Reading
tags:
  - 3D Reconstruction
authors:
  - zhazi
---

# 阅读：Occupancy Networks: Learning 3D Reconstruction in Function Space

在对抗攻防中，防御方发展出一类基于输入净化的方法，通过将对抗样本恢复为良性样本来实现防御。**IF-Defense** ——三维对抗防御中的一项研究——属于此类方法，其先将点云重建为网格，然后在网格层面消除异常的形变，从而实现防御。其使用的曲面重建方法来自于本篇论文，因此，这里只关注三个问题：**1.** 什么是占据网络？**2.** 怎么实现占据网络？**3.** 怎么使用占据网络？

??? info "论文基本信息"

    - 论文链接：[arxiv](https://arxiv.org/abs/1812.03828)
    - 代码链接：[github](https://github.com/autonomousvision/occupancy_networks)
    - 补充材料：[pdf](https://www.cvlibs.net/publications/Mescheder2019CVPR_supplementary.pdf)
    - AI 摘要：**占据网络**是一种新型的三维重建方法，它通过学习连续的三维**占据函数**来隐式表示三维表面，从而克服了以往方法在分辨率和拓扑结构方面的局限性。该方法能够以无限分辨率编码三维结构，同时保持较低的内存占用。此外，占据网络能够从多种输入类型（例如点云、单张图像和低分辨率体素表示）中重建三维几何形状，并在多个基准测试中取得了有竞争力的结果。
<!-- more -->

## 什么是占据网络？

论文使用占据函数来表示物体表面。占据函数 $f:\mathbb{R}^3\rightarrow \{0,1\}$ 将任意空间坐标 $p=(x,y,z)$ 映射为 $0$ 或 $1$。其中 $0/1$​​ 表示该点在表面内/外。注意占据函数对于不同的曲面 $C$ 有不同的形式，所以更具体的写法应该是

$$
f(p;C):\mathbb{R}^3\rightarrow \{0,1\}.
$$

论文的思路是将离散的占据信息转为连续的占据率信息，然后通过一个二分类网络近似占据函数，（即： $f_{\theta}:\mathbb{R}^3\rightarrow [0,1]$），最后使用该网络的决策边界来重建曲面（等值面提取）。如前面所述，占据函数与要建模的曲面关联，此外，我们关于曲面的信息 $C$ 来自于我们的观测 $o$，因此网络还需要接受观测值的做为输入，形式上，这个近似网络可以写为：

$$
f_{\theta}(p, o):\mathbb{R}^3\times \mathcal{X}\rightarrow [0,1].
$$

## 怎么实现占据网络？

实现一个二分类网络有很多方法，这里要考虑的是如何将观测信息嵌入网络。论文引入了一个编码器 $g_{\phi}(\cdot)$ 对观测信息进行编码，其表达一个条件分布 $p(z|(p, o))$，在训练时，按惯例让这个分布接近一个先验分布（通常为正态分布）。因此，论文实现的占据网络包含两部分，一个二分类器 $f_{\theta}$ 和一个编码器 $g_{\phi}$。对于二分类器，论文使用 5 个 `ResNet` 块 + 全连接层实现并使用条件批量归一化（CBN）嵌入条件信息（编码器的输出）。而对于编码器，论文依据具体任务选用了不同的结构，相关配置如下：

- 单视图：ResNet18
- 点云：PointNet
- 体素：3D CNN

??? tip "使用正态分布做先验分布"

    AI 回答：

    1. 为什么要先验分布？
    以变分自编码器（VAE）为例，先验分布 \( p(z) \) 的引入有以下几个重要原因：
        - **表示学习**：先验分布为潜在变量 \( z \) 提供了一个标准化的、低维的表示空间。这种表示可以捕获输入数据 \( x \) 的高层特征，有助于数据的压缩和特征提取。
        - **生成模型**：VAE不仅是一个自编码器，也是一个生成模型。通过先验分布，我们可以独立于输入数据生成新的样本。这是通过从先验分布 \( p(z) \) 中采样潜在变量，然后通过解码器生成新的数据点来实现的。
        - **正则化**：先验分布作为一种正则化手段，可以防止模型过拟合。通过假设潜在变量遵循一个简单的分布，模型被迫学习数据中的通用特征，而不是仅仅记住训练数据。
        - **可解释性**：先验分布可以提供潜在空间的解释性。例如，在潜在空间中，接近的点可能对应于输入空间中相似的数据点，这有助于理解数据的内在结构。
    2. 为什么使用正态分布？
    使用正态分布作为先验分布和变分分布的原因包括：
        - **数学上的便利性**：正态分布具有很好的数学性质，如闭合形式的概率密度函数和对数概率密度函数，这使得在优化过程中可以方便地计算和求导。
        - **中心极限定理**：正态分布是许多随机变量的和的极限分布，这在统计学中被称为中心极限定理。这意味着在实际应用中，许多自然现象和数据的分布可以近似为正态分布。
        - **连续性和平滑性**：正态分布是连续分布，这意味着潜在空间中的任何点都可以通过编码器生成，并且潜在空间是平滑的，即相似的输入数据会有相似的潜在表示。
        - **易于采样**：从正态分布中采样相对简单，这是由于正态分布可以通过Box-Muller变换或更高效的Ziggurat算法进行高效采样。
        - **重参数化技巧**：在VAE中，为了能够通过梯度下降来训练模型，需要使用重参数化技巧。正态分布允许我们通过从标准正态分布中采样并应用均值和方差的变换来重参数化，这使得我们可以计算关于编码器参数的梯度。
      总的来说，正态分布的假设在VAE中提供了一种平衡，使得模型既能够捕捉数据的复杂性，又能够在训练和生成过程中保持计算上的可行性。

## 怎么使用占据网络？
